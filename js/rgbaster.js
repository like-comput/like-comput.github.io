var getContext=function(t,e){var r=document.createElement("canvas");return r.setAttribute("width",t),r.setAttribute("height",e),r.getContext("2d")},getImageData=function(t,e){void 0===e&&(e=1);var r=new Image;return t.startsWith("data")||(r.crossOrigin="Anonymous"),new Promise((function(n,o){r.onload=function(){var t=r.width*e,o=r.height*e,a=getContext(t,o);a.drawImage(r,0,0,t,o);var i=a.getImageData(0,0,t,o).data;n(i)};var a=function(){return o(new Error("An error occurred attempting to load image"))};r.onerror=a,r.onabort=a,r.src=t}))},getCounts=function(t,e){for(var r={},n=0;n<t.length;n+=4){var o=t[n+3];if(0!==o){var a=Array.from(t.subarray(n,n+3));if(-1===a.indexOf(void 0)){var i=o&&255!==o?"rgba("+a.concat([o]).join(",")+")":"rgb("+a.join(",")+")";-1===e.indexOf(i)&&(r[i]?r[i].count++:r[i]={color:i,count:1})}}}return Object.values(r).sort((function(t,e){return e.count-t.count}))},defaultOpts={ignore:[],scale:1},index=function(t,e){void 0===e&&(e=defaultOpts);try{var r=(e=Object.assign({},defaultOpts,e)).ignore,n=e.scale;return(n>1||n<=0)&&console.warn("You set scale to "+n+", which isn't between 0-1. This is either pointless (> 1) or a no-op (â‰¤ 0)"),Promise.resolve(getImageData(t,n)).then((function(t){return getCounts(t,r)}))}catch(t){return Promise.reject(t)}};module.exports=index;